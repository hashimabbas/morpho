import{r as d,j as e,L as A,$ as L,S as n}from"./app-eR22eJJR.js";import{A as B}from"./app-layout-Bk2YOnpo.js";import{B as b}from"./button-Kd8uzQOT.js";import{D as P,a as R,b as O,c as U,d as z}from"./dialog-4FPjHLi1.js";import{I as V,L as m}from"./label-gmKI0995.js";import{C as j}from"./checkbox-2oeVDQ_M.js";import{S as q,a as G,b as J,c as K,d as x}from"./select-d9NagaF_.js";import{B as Q}from"./badge-DLxl7lon.js";import{c as W,S as v,u as h,w as X}from"./index.module-D9hJSCWB.js";import{D as Y}from"./download-DshiFNip.js";import{C as Z}from"./circle-check-big-DxLkoRtp.js";import{c as ee}from"./createLucideIcon-BiDnvwfG.js";import{f as g}from"./format-CBpsKyOP.js";import"./index-Cb0vj6L6.js";import"./utils-DVM6Vl9F.js";import"./clsx-B-dksMZM.js";import"./bundle-mjs-AdmevC4f.js";import"./index-UISMkL9B.js";import"./index-CrJkNIBR.js";import"./Combination-CG7MJnWH.js";import"./x-5gc9e8GB.js";import"./tooltip-Dgl4IlFs.js";import"./index-CZWrlyRJ.js";import"./index-DOlnxhaM.js";import"./index-Com5JFnz.js";import"./floating-ui.react-dom-CwybARVP.js";import"./index-Dn_pCv6v.js";import"./dropdown-menu-BJsCoczS.js";import"./avatar-C_Hg_1sA.js";import"./app-logo-icon-rcn01X06.js";import"./mail-dHZ694R6.js";import"./chevron-right-BhJEmcEm.js";import"./index-_6blBvPu.js";import"./check-DeqtcoWs.js";import"./chevron-down-Cpimzff7.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],se=ee("UserPlus",ae),te=[{title:"Dashboard",href:route("dashboard.index")},{title:"Messages",href:route("dashboard.messages"),isCurrent:!0}],re={data:[],links:[],from:0,to:0,total:0},le={search:null,filter:null};function Oe(N){const{messages:s=re,filters:k=le}=N,[r,S]=d.useState(null),[w,p]=d.useState(!1),[u,C]=d.useState(k.search||""),[l,i]=d.useState([]),[_,y]=d.useState(!1);d.useEffect(()=>{i([])},[s.total]);const M=W(a=>{n.get(route("dashboard.messages"),{search:a},{preserveState:!0,replace:!0,preserveScroll:!0})},300),D=a=>{n.get(route("dashboard.messages"),{search:u,filter:a},{preserveState:!0,replace:!0,preserveScroll:!0})},E=a=>{S(a),p(!0),a.is_read||n.post(route("dashboard.messages.markAsRead",a.id),{},{preserveScroll:!0})},$=(a,t)=>{a.stopPropagation(),n.post(route("dashboard.messages.convertToContact",t),{},{preserveScroll:!0})},I=a=>{i(t=>t.includes(a)?t.filter(c=>c!==a):[...t,a])},T=()=>{l.length===s.data.length?i([]):i(s.data.map(a=>a.id))},H=()=>{if(l.length===0){alert("Please select messages to export.");return}y(!0);const t=s.data.filter(o=>l.includes(o.id)).map(o=>({Name:o.name,Email:o.email,Subject:o.subject,Message:o.message,Status:o.is_read?"Read":"Unread","Received At":g(new Date(o.created_at),"yyyy-MM-dd HH:mm:ss")})),c=h.json_to_sheet(t),f=h.book_new();h.book_append_sheet(f,c,"Selected Messages"),X(f,"SelectedMessages.xlsx"),y(!1)},F=s.data.length>0&&l.length===s.data.length;return e.jsxs(B,{breadcrumbs:te,children:[e.jsx(A,{title:"Contact Messages"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-hidden",children:e.jsxs("div",{className:"flex-1 rounded-xl border border-sidebar-border/70 dark:border-sidebar-border dark:bg-gray-800 flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"Inbox"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Browse, filter, and convert contact form messages."})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50/50 dark:bg-gray-800/50 border-b border-gray-200 dark:border-gray-700",children:[e.jsx(j,{checked:F,onCheckedChange:T,"aria-label":"Select all messages on this page"}),e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"}),e.jsx(V,{type:"search",placeholder:"Search by name, email...",value:u,onChange:a=>{C(a.target.value),M(a.target.value)},className:"pl-9"})]}),e.jsxs(q,{onValueChange:D,children:[e.jsx(G,{className:"w-[180px]",children:e.jsx(J,{placeholder:"Filter by status"})}),e.jsxs(K,{children:[e.jsx(x,{value:"all",children:"All Messages"}),e.jsx(x,{value:"unread",children:"Unread"}),e.jsx(x,{value:"read",children:"Read"})]})]}),e.jsxs(b,{variant:"outline",onClick:H,disabled:l.length===0||_,className:"ml-auto",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Export ",l.length>0?`${l.length} Selected`:""]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:s.data.length>0?e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:s.data.map(a=>e.jsxs("div",{className:`flex w-full items-start gap-4 p-4 text-left ${a.is_read?"bg-white dark:bg-gray-800":"bg-blue-50 dark:bg-gray-700/50"}`,children:[e.jsx(j,{checked:l.includes(a.id),onCheckedChange:()=>I(a.id),"aria-label":`Select message from ${a.name}`,className:"mt-1"}),e.jsxs("div",{className:"flex-1 overflow-hidden cursor-pointer",onClick:()=>E(a),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:`text-sm truncate pr-4 ${!a.is_read&&"font-semibold"} ${a.is_read?"text-gray-900 dark:text-gray-100":"text-blue-700 dark:text-blue-200"}`,children:[a.name," ",e.jsxs("span",{className:"text-gray-500 font-normal",children:["(",a.email,")"]})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:g(new Date(a.created_at),"MMM dd, yyyy HH:mm")})]}),e.jsxs("p",{className:`mt-1 truncate text-sm ${a.is_read?"text-gray-600 dark:text-gray-300":"text-gray-800 dark:text-gray-100"}`,children:[e.jsx("span",{className:"font-medium mr-2",children:a.subject}),"- ",a.message.substring(0,100),a.message.length>100?"...":""]})]}),e.jsx("div",{className:"ml-auto flex-shrink-0",children:a.converted_to_contact_id?e.jsxs(Q,{variant:"secondary",className:"cursor-default",children:[e.jsx(Z,{className:"h-4 w-4 mr-1 text-green-500"}),"Converted"]}):e.jsxs(b,{variant:"outline",size:"sm",onClick:t=>$(t,a.id),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Convert to Contact"]})})]},a.id))}):e.jsxs("div",{className:"mt-4 rounded-md p-12 text-center",children:[e.jsx(v,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900 dark:text-gray-100",children:"No messages found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Try adjusting your search or filter to find what you're looking for."})]})}),s.links.length>3&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Showing ",e.jsx("span",{className:"font-medium",children:s.from})," to ",e.jsx("span",{className:"font-medium",children:s.to})," of"," ",e.jsx("span",{className:"font-medium",children:s.total})," results"]}),e.jsx("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:s.links.map((a,t)=>e.jsx(L,{href:a.url||"#",className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ring-1 ring-inset ring-gray-300 focus:z-20 dark:ring-gray-600 ${a.active?"z-10 bg-indigo-600 text-white":"text-gray-900 hover:bg-gray-50 dark:text-gray-100 dark:hover:bg-gray-700"} ${a.url===null?"cursor-not-allowed opacity-50":""} ${t===0?"rounded-l-md":""} ${t===s.links.length-1?"rounded-r-md":""}`,preserveScroll:!0,dangerouslySetInnerHTML:{__html:a.label}},t))})]})]})}),e.jsx(P,{open:w,onOpenChange:p,children:e.jsxs(R,{className:"sm:max-w-[700px]",children:[e.jsxs(O,{children:[e.jsxs(U,{children:["Message from ",r==null?void 0:r.name]}),e.jsxs(z,{className:"text-sm text-gray-500 dark:text-gray-400",children:["Received on ",r!=null&&r.created_at?g(new Date(r.created_at),"EEEE, MMM dd, yyyy HH:mm"):""]})]}),r&&e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(m,{htmlFor:"senderName",className:"text-right",children:"From:"}),e.jsxs("span",{id:"senderName",className:"col-span-3 font-medium",children:[r.name," <",r.email,">"]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(m,{htmlFor:"messageSubject",className:"text-right",children:"Subject:"}),e.jsx("span",{id:"messageSubject",className:"col-span-3 font-medium",children:r.subject})]}),e.jsxs("div",{className:"grid grid-cols-4 items-start gap-4 mt-2",children:[e.jsx(m,{htmlFor:"messageContent",className:"text-right pt-2",children:"Message:"}),e.jsx("div",{id:"messageContent",className:"col-span-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-md border border-gray-200 dark:border-gray-600 max-h-[300px] overflow-y-auto whitespace-pre-wrap text-sm text-gray-700 dark:text-gray-200",children:r.message})]})]})]})})]})}export{Oe as default};
